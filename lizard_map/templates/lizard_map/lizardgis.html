{% extends "lizard_ui/lizardbase.html" %}
{% load i18n %}
{% load workspaces %}

{% block css %}
  {{ block.super }}
  <link type="text/css"
        href="{{ STATIC_URL }}lizard_map/lizard_map.css"
        rel="stylesheet"
        media="screen, projection" />
{% endblock css %}

{% block javascript %}
  {{ block.super }}

<!-- underscore is used for backbone and NensLayerSwitcher -->
<script type="text/javascript"
        src="{{ STATIC_URL }}backbone/underscore-min.js"></script>
<!-- Backbone is used for animations.js -->
<script type="text/javascript"
        src="{{ STATIC_URL }}backbone/backbone-min.js"></script>
<script type="text/javascript"
        src="{{ STATIC_URL }}lizard_map/animations.js"></script>
<script type="text/javascript"
		src="{{ STATIC_URL }}lizard_ui/OpenLayers.Control.NensLayerSwitcher.js"></script>
<script type="text/javascript">
    var lizard_map = {};
    lizard_map.nothingFoundMessage = '{% trans "No items found near this location." %}';
    lizard_map.daterangepicker_options = {
        format: 'DD-MM-YYYY',
        locale: {
            applyLabel: '{% trans "Confirm" %}',
            cancelLabel: '{% trans "Cancel" %}',
            customRangeLabel: '{% trans "Custom range" %}',
            daysOfWeek: '{% trans "sun mon tue wed thu fri sat" %}'.split(' '),
            monthNames: '{% trans "January February March April May June July August September October November December" %}'.split(' '),
            firstDay: 0
        },
        ranges: {
{% block date-ranges %}
            '{% trans "Past day" %}': [
                moment.utc().subtract('days', 1),
                moment.utc(),
                'today'
            ],
            '{% trans "Past 2 days" %}': [
                moment.utc().subtract('days', 2),
                moment.utc(),
                '2_day'
            ],
            '{% trans "Past week" %}': [
                moment.utc().subtract('weeks', 1),
                moment.utc(),
                'week'
            ],
            '{% trans "Past month" %}': [
                moment.utc().subtract('months', 1),
                moment.utc(),
                'month'
            ],
            '{% trans "Past year" %}': [
                moment.utc().subtract('years', 1),
                moment.utc(),
                'year'
            ]
{% endblock date-ranges %}
        }
    };
</script>
<script type="text/javascript"
        src="{{ STATIC_URL }}lizard_map/lizard_map.js"></script>
{% endblock javascript %}

{% block map-javascript %}
  {{ block.super }}
<script type="text/javascript">
    var _view_state = {
        range_type: '2_day',                        // string 'year', 'custom', '2_day' etc.
        dt_start: moment.utc().subtract('days', 2), // Moment.js date object
        dt_end: moment.utc()                        // Moment.js date object
    };
    {% with view.view_state as view_state %}
        {% if view_state %}
            _view_state.range_type = "{{ view_state.range_type }}";
            {% if view_state.range_type == 'custom' %}
                _view_state.dt_start = moment.utc("{{ view_state.dt_start|date:"c" }}");
                _view_state.dt_end = moment.utc("{{ view_state.dt_end|date:"c" }}");
            {% else %}
                _view_state.dt_start = null;
                _view_state.dt_end = null;
            {% endif %}
        {% endif %}
    {% endwith %}
</script>
{% endblock map-javascript %}

{% block content %}
<div id="map"></div>
{% endblock content %}
