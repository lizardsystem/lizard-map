<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>workspace.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  
  <div class='section'>
    <div class='docs'><h1>workspace.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>The colors that are used in graphs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">COLORS_DEFAULT</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;magenta&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;magenta&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;yellow&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;black&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;cyan&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;cyan&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;lightblue&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;lightblue&#39;</span><span class="p">)},</span>
    <span class="p">{</span><span class="s">&#39;mapnik&#39;</span><span class="p">:</span> <span class="s">&#39;grey&#39;</span><span class="p">,</span> <span class="s">&#39;display_name&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;grey&#39;</span><span class="p">)},</span>
    <span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>save workspaces to session</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">save_workspaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>workspace_group_ids = {}
for group, workspace_list in self.workspaces.items():
<pre>workspace_group_ids[group] = [workspace.id for workspace in
workspace_list]
self.request.session['workspaces'] = workspace_group_ids
logger.debug('WorkspaceManager.save_workspaces: saved '
'workspace_group_ids in session.')
</pre>
def load_workspaces(self, workspace_group_ids=None):
load workspaces from session</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">note</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s">&#39;workspaces&#39;</span><span class="p">]</span> <span class="n">must</span> <span class="n">be</span> <span class="n">filled</span> <span class="n">before</span>
        <span class="n">using</span> <span class="n">this</span> <span class="n">function</span>

        <span class="n">returns</span> <span class="n">number</span> <span class="n">of</span> <span class="n">workspaces</span> <span class="n">that</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">loaded</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">        errors = 0</span>
<span class="s">        if workspace_group_ids is None:</span>
<span class="s">            if &#39;workspaces&#39; in self.request.session:</span>
<span class="s">                workspace_group_ids = self.request.session[&#39;workspaces&#39;]</span>
<span class="s">            else:</span>
<span class="s">                logger.warn((&#39;WorkspaceManager.load_workspaces: no workspaces&#39;</span>
<span class="s">                             &#39; in kwargs or in session.&#39;))</span>
<span class="s">                return 1</span>

<span class="s">#DIVIDER</span>
<span class="s">        for group, workspace_ids in workspace_group_ids.items():</span>
<span class="s">            self.workspaces[group] = []</span>
<span class="s">            for workspace_id in workspace_ids:</span>
<span class="s">                try:</span>
<span class="s">                    new_workspace = Workspace.objects.get(pk=workspace_id)</span>
<span class="s">                    self.workspaces[group].append(new_workspace)</span>
<span class="s">                except Workspace.DoesNotExist:</span>
<span class="s">                    errors += 1</span>
<span class="s">        return errors</span>


<span class="s">#DIVIDER</span>
<span class="s">        for workspace in self.workspaces[category]:</span>
<span class="s">            workspace.workspace_items.all().delete()</span>


<span class="s">#DIVIDER</span>
<span class="s">    def load_or_create(self, new_workspace=False):</span>
<span class="s">#DIVIDER</span>

<span class="s">        self.workspaces = {}</span>
<span class="s">        changes = False</span>
<span class="s">        if &#39;workspaces&#39; in self.request.session:</span>
<span class="s">            changes = self.load_workspaces()</span>


<span class="s">#DIVIDER</span>
<span class="s">        if not DEFAULT_WORKSPACES in self.workspaces:</span>
<span class="s">            try:</span>
<span class="s">                self.workspaces[DEFAULT_WORKSPACES] = [</span>
<span class="s">                    Workspace.objects.get(name=&#39;achtergrond&#39;)]</span>

<span class="s">#DIVIDER</span>
<span class="s">            except Workspace.DoesNotExist:</span>
<span class="s">                pass</span>
<span class="s">            changes = True</span>

<span class="s">        if (not TEMP_WORKSPACES in self.workspaces or</span>
<span class="s">            not self.workspaces[TEMP_WORKSPACES]):</span>
<span class="s">            workspace_temp = Workspace(name=TEMP_WORKSPACES)</span>
<span class="s">            workspace_temp.save()</span>
<span class="s">            self.workspaces[TEMP_WORKSPACES] = [workspace_temp]</span>
<span class="s">            changes = True</span>

<span class="s">        if (new_workspace or</span>
<span class="s">            not USER_WORKSPACES in self.workspaces or</span>
<span class="s">            not len(self.workspaces[USER_WORKSPACES])):</span>
<span class="s">            workspace_user = Workspace()</span>
<span class="s">            workspace_user.save()</span>
<span class="s">            self.workspaces[USER_WORKSPACES] = [workspace_user]</span>
<span class="s">            changes = True</span>


<span class="s">#DIVIDER</span>
<span class="s">        if len(self.workspaces[USER_WORKSPACES][0].collages.all()) == 0:</span>
<span class="s">            self.workspaces[USER_WORKSPACES][0].collages.create()</span>

<span class="s">        if changes:</span>
<span class="s">            self.save_workspaces()</span>
<span class="s">        return self.workspaces</span>


<span class="s">#DIVIDER</span>
<span class="s">    def _in_collection(self, workspace):</span>
<span class="s">#DIVIDER</span>
<span class="s">        for group, workspaces in self.workspaces.items():</span>
<span class="s">            if workspace in workspaces:</span>
<span class="s">                return True</span>
<span class="s">        return False</span>


<span class="s">#DIVIDER</span>
<span class="s">    def add_other(self, workspace_id):</span>
<span class="s">#DIVIDER</span>
<span class="s">class WorkspaceItemAdapter(object):</span>
<span class="s">#DIVIDER</span>

<span class="s">    layer_arguments = {}</span>
<span class="s">    is_animatable = False</span>
<span class="s">    allow_custom_legend = False</span>


<span class="s">#DIVIDER</span>
<span class="s">    def layer(self, layer_ids=None, request=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">        raise NotImplementedError</span>


<span class="s">#DIVIDER</span>
<span class="s">    def extent(self, identifiers=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">    def search(self, x, y, radius=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">        raise NotImplementedError</span>


<span class="s">#DIVIDER</span>
<span class="s">    def value_aggregate(self, identifier, aggregate_functions,</span>
<span class="s">                        start_date=None, end_date=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">    def values(self, identifier, start_date, end_date):</span>
<span class="s">#DIVIDER</span>
<span class="s">        raise NotImplementedError</span>


<span class="s">#DIVIDER</span>
<span class="s">    def value_aggregate_default(self, identifier, aggregate_functions,</span>
<span class="s">                                start_date, end_date):</span>
<span class="s">#DIVIDER</span>
<span class="s">                if key == &#39;min&#39;:</span>
<span class="s">                    result_value = min(values_only)</span>
<span class="s">                elif key == &#39;max&#39;:</span>
<span class="s">                    result_value = max(values_only)</span>
<span class="s">                elif key == &#39;avg&#39;:</span>
<span class="s">                    result_value = float(sum(values_only)) / len(values_only)</span>
<span class="s">                elif key == &#39;count_lt&#39;:</span>
<span class="s">                    if value is None:</span>
<span class="s">                        result_value = None</span>
<span class="s">                    else:</span>
<span class="s">                        result_value = 0</span>
<span class="s">                        for v in values_only:</span>
<span class="s">                            if v &lt; value:  # value is boundary value</span>
<span class="s">                                result_value += 1</span>
<span class="s">                elif key == &#39;count_gte&#39;:</span>
<span class="s">                    if value is None:</span>
<span class="s">                        result_value = None</span>
<span class="s">                    else:</span>
<span class="s">                        result_value = 0</span>
<span class="s">                        for v in values_only:</span>
<span class="s">                            if v &gt;= value:  # value is boundary value</span>
<span class="s">                                result_value += 1</span>
<span class="s">                elif key == &#39;percentile&#39;:</span>
<span class="s">                    if value is None:</span>
<span class="s">                        result_value = None</span>
<span class="s">                    else:</span>
<span class="s">                        rank = int(value * len(values_only) / 100.0 + 0.5)</span>
<span class="s">                        result_value = values_only[rank]</span>
<span class="s">                else:</span>
<span class="s">                    result_value = None</span>
<span class="s">            except (ValueError, IndexError, TypeError, ZeroDivisionError):</span>
<span class="s">                result_value = None</span>
<span class="s">            result[key] = result_value</span>
<span class="s">        return result</span>


<span class="s">#DIVIDER</span>
<span class="s">    def location(self, identifier=None, layout=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">        raise NotImplementedError</span>


<span class="s">#DIVIDER</span>
<span class="s">    def line_styles(self, identifiers):</span>
<span class="s">#DIVIDER</span>
<span class="s">    def image(self, identifiers=None, start_date=None, end_date=None,</span>
<span class="s">              width=None, height=None, layout_extra=None):</span>
<span class="s">#DIVIDER</span>

<span class="s">        raise NotImplementedError</span>


<span class="s">#DIVIDER</span>
<span class="s">    def symbol_url(self, identifier=None, start_date=None, end_date=None,</span>
<span class="s">                   icon_style=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">        sm = SymbolManager(ICON_ORIGINALS, os.path.join(</span>
<span class="s">                settings.MEDIA_ROOT,</span>
<span class="s">                &#39;generated_icons&#39;))</span>
<span class="s">        if icon_style is None:</span>
<span class="s">            icon_style = {&#39;icon&#39;: &#39;empty.png&#39;}</span>
<span class="s">        output_filename = sm.get_symbol_transformed(icon_style[&#39;icon&#39;],</span>
<span class="s">                                                    **icon_style)</span>
<span class="s">        return settings.MEDIA_URL + &#39;generated_icons/&#39; + output_filename</span>


<span class="s">#DIVIDER</span>
<span class="s">    def html(self, snippet_group=None, identifiers=None, layout_options=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">    def html_default(self, snippet_group=None, identifiers=None,</span>
<span class="s">                     layout_options=None, template=None,</span>
<span class="s">                     extra_render_kwargs=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">        if snippet_group:</span>

<span class="s">#DIVIDER</span>
<span class="s">            img_url = reverse(</span>
<span class="s">                &quot;lizard_map.snippet_group_image&quot;,</span>
<span class="s">                kwargs={&#39;snippet_group_id&#39;: snippet_group.id},</span>
<span class="s">                )</span>
<span class="s">        else:</span>

<span class="s">#DIVIDER</span>
<span class="s">            img_url = reverse(</span>
<span class="s">                &quot;lizard_map.workspace_item_image&quot;,</span>
<span class="s">                kwargs={&#39;workspace_item_id&#39;: self.workspace_item.id},</span>
<span class="s">                )</span>

<span class="s">#DIVIDER</span>
<span class="s">            if legend:</span>
<span class="s">                for identifier in identifiers:</span>
<span class="s">                    if not &#39;layout&#39; in identifier:</span>
<span class="s">                        identifier[&#39;layout&#39;] = {}</span>
<span class="s">                    identifier[&#39;layout&#39;][&#39;legend&#39;] = True</span>

<span class="s">            identifiers_escaped = [json.dumps(identifier).replace(&#39;&quot;&#39;, &#39;%22&#39;)</span>
<span class="s">                                   for identifier in identifiers]</span>
<span class="s">            img_url = img_url + &#39;?&#39; + &#39;&amp;&#39;.join([&#39;identifier=</span><span class="si">%s</span><span class="s">&#39; </span><span class="si">% i</span><span class="s"> for i in</span>
<span class="s">                                                identifiers_escaped])</span>


<span class="s">#DIVIDER</span>
<span class="s">        display_group = [self.location(**identifier) for identifier in</span>
<span class="s">                         identifiers]</span>

<span class="s">        if template is None:</span>
<span class="s">            template = &#39;lizard_map/popup.html&#39;</span>
<span class="s">        render_kwargs = {</span>
<span class="s">            &#39;title&#39;: title,</span>
<span class="s">            &#39;display_group&#39;: display_group,</span>
<span class="s">            &#39;img_url&#39;: img_url,</span>
<span class="s">            &#39;symbol_url&#39;: self.symbol_url(),</span>
<span class="s">            &#39;add_snippet&#39;: add_snippet,</span>
<span class="s">            &#39;editing&#39;: editing,</span>
<span class="s">            &#39;snippet_group&#39;: snippet_group,</span>
<span class="s">                &#39;colors&#39;: COLORS_DEFAULT,</span>
<span class="s">            }</span>

<span class="s">        if extra_render_kwargs is not None:</span>
<span class="s">            render_kwargs.update(extra_render_kwargs)</span>

<span class="s">        return render_to_string(</span>
<span class="s">            template,</span>
<span class="s">            render_kwargs)</span>


<span class="s">#DIVIDER</span>
<span class="s">    def legend(self, updates=None):</span>
<span class="s">#DIVIDER</span>
<span class="s">    def legend_object_default(self, legend_name):</span>
<span class="s">#DIVIDER</span>
<span class="s">            logger.warn(&quot;Could not find legend for key &#39;</span><span class="si">%s</span><span class="s">&#39;, &quot;</span>
<span class="s">                        &quot;please configure the legend. &quot;</span>
<span class="s">                        &quot;Now using fallback (red).&quot;)</span>
<span class="s">            color = Color(&#39;ff0000&#39;)</span>
<span class="s">            found_legend = Legend(descriptor=&quot;&quot;, min_color=color,</span>
<span class="s">                                  max_color=color, too_low_color=color,</span>
<span class="s">                                  too_high_color=color)</span>

<span class="s">        return found_legend</span>


<span class="s">#DIVIDER</span>
<span class="s">    def legend_default(self, legend_object):</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Workspaces are grouped by key TEMP_WORKSPACES, USER_WORKSPACES, etc.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>clear all items in workspace category</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>load workspaces references by session['workspaces'] or</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>create new workspace (saves in case of changes to workspaces)</p>
<p>workspaces are returned in a dictionary:
{
'default': [...default layers],
'temp': workspace_temp,
'user': [...user workspaces]
}</p>
<p>they are stored in the session as a dictionary of ids:
{
'default': [id1, id2, ...],
'temp': [id, ],
'user': [id3, id4, ...],
}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>check if components exist, else create them</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>^^^ TODO: use non-Dutch name.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>create collage if necessary, it is stored in the workspace</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Check if given workspace is already in current collection.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Add a workspace in "other",</p>
<p>if the workspace is not already in your collection.</p>
<p>Sometimes you want to add workspaces from others</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Base class for workspace_item adapters.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Lizard-map needs to display workspace items.  Search in them according to
clicks on the map.  And so on.  But workspace items can be anything.  An
<em>adapter</em> adapts a workspace item to what lizard-map needs.</p>
<p>So for every new kind of workspace item, you'll need a fresh adapter that
subclasses this base adapter.  And you'll need to implement the
NotImplementedError'ed methods.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Generates and returns layers, styles.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Layers is a list of mapnik layers.</p>
<p>Styles is a list of mapnik styles (which are used in the
layers).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Returns extent {'west':.., 'north':.., 'east':.., 'south':..}
in google projection. None for each key means unknown.</p>
<p>Optional: If identifiers is given, return extent for those
identifiers only.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Search by coordinates. Return list of dicts for matching</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>items.</p>
<p>{'distance': <float>,
'name': <name>,
'shortname': <short name>,
'workspace_item': &lt;...&gt;,
'identifier': {...},
'google_coords': (x, y) coordinate in google,
'object': <object>} of closest fews point that matches x, y, radius.</p>
<p>Required: distance, name, workspace_item, google_coords
Highly recommended (else some functions will not work):
identifier (for popups)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Calculates aggregated values of identifier. Returns dict with
aggregation function as key and value as value. {'avg': 3.5,
'min': 1, 'max': 6}.</p>
<p>The given functions in aggregate_functions will be calculated:</p>
<p>aggregate_functions = {
'avg': None,
'min': None,
'max': None,
'count_lt': <boundary value>,
'count_gte': <boundary value>,
<pre>'percentile': <percentile>     # returns value of given percentile
<custom function>: <custom input>  # for special aggregates,</p>
<h1>such as average in part</h1>
<h1>of a grid</h1>
<p>}
</pre>
all functions are optional.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Return values in list of dictionaries (datetime, value, unit)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Default implementation for value_aggregate.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Values are not always numbers - in case of strings
this will result in a TypeError
the sequence can be empty</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Return fews point representation corresponding to filter_id,</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>location_id and parameter_id in same format as search function</p>
<p>layout is a dict with extra optional layout parameters:
y_min, y_max, y_label, x_label, line_avg, line_max, line_min</p>
<p>{'object': &lt;...&gt;,
'google_x': x coordinate in google,
'google_y': y coordinate in google,
'workspace_item': &lt;...&gt;,
'identifier': {...},
'grouping_hint': optional unique group identifier, i.e. unit m3/s}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Get line styles for given identifiers. For each set of
identifiers, the line styles are calculated deterministic.</p>
<p>EXPERIMENTAL: this function can be used to generate a legend
function, seperately of the image function.</p>
<p>Keys are str(identifiers). Values are dicts with properties
'color', 'linestyle', 'linewidth', 'max_linestyle',
'max_linewidth', 'min_linestyle', 'min_linewidth', ...</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Return image of given parameters.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>layout_extra can have the following parameters (all are optional):</p>
<p>'y_label' = value y_label
'x_label' = value x_label
'y_min' = value y_min
'y_max' = value self.layout_y_max
'title' = title
'horizontal_lines' = [{
'name': <line name>,
'value': <value>,
'style': {'linewidth': 3,
<pre>'linestyle': '--',
'color': 'green'}, }]
'vertical_lines' = [{
'name': <line name>,
'value': <value (datetime)>,
'style': {'linewidth': 3,
'linestyle': '--',
'color': 'green'}, }]</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Return symbol for identifier.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p></pre>
Implementation: respect the fact when icon_style is already
given. If it's empty, generate own icon if applicable.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>Html output for given identifiers. Optionally layout_options
can be provided. Default layout_options:</p>
<p>layout_options = {'add_snippet': False,
<pre>'editing': False}</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p></pre>Returns html representation of given snippet_group OR
identifiers (snippet_group has priority). If a snippet_group
is provided, more options are available.</p>
<p>This particular view always renders a list of items, then 1
image</p>
<p>Use this function if html function behaviour is default:
def html(self, identifiers):
<pre>return super(WorkspaceItemAdapterKrw, self).html_default(
identifiers)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Image url: for snippet_group there is a special (dynamic) url.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Image url for snippet_group: can change if snippet_group
properties are altered.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Image url: static url composed with all options and layout tweaks</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>If legend option: add legend to layout of identifiers</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Make 'display_group'</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p></pre>Returns legend in a list of dictionaries. If this method
returns a list, then the legend icon will appear in your
workspace.</p>
<p>Dictionary = {'img_url': <url>, 'description': <description>}</p>
<p>updates: ...</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Get legend object. If no appropriate legend was found, a
legend object will be created and returned.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Fallback if no legend found (should not happen)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div><div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>Default implementation for legend. A legend is displayed</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
